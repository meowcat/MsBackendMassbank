<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Description and usage of MsBackendMassbank â€¢ MsBackendMassbank</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Description and usage of MsBackendMassbank">
<meta property="og:description" content="MsBackendMassbank">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsBackendMassbank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MsBackendMassbank.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/michaelwitting/MsBackendMassbank/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MsBackendMassbank_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Description and usage of MsBackendMassbank</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/michaelwitting/MsBackendMassbank/blob/master/vignettes/MsBackendMassbank.Rmd"><code>vignettes/MsBackendMassbank.Rmd</code></a></small>
      <div class="hidden name"><code>MsBackendMassbank.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.12/MsBackendMassbank">MsBackendMassbank</a></em><br><strong>Authors</strong>: Michael Witting [aut, cre] (<a href="https://orcid.org/0000-0002-1462-4426" class="uri">https://orcid.org/0000-0002-1462-4426</a>)<br><strong>Last modified:</strong> 2020-09-16 12:22:50<br><strong>Compiled</strong>: Wed Sep 16 12:31:36 2020</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>Spectra</code> package provides a central infrastructure for the handling of Mass Spectrometry (MS) data. The package supports interchangeable use of different <em>backends</em> to import MS data from a variety of sources (such as mzML files). The <code>MsBackendMassbank</code> package allows the import of handle MS/MS spectrum data from <a href="https://github.com/MassBank/MassBank-data">Massbank</a> files. This vignette illustrates the usage of the <code>MsBackendMassbank</code> package.</p>
</div>
<div id="importing-msms-data-from-massbank-files" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-msms-data-from-massbank-files" class="anchor"></a>Importing MS/MS data from MassBank files</h1>
<p>MassBAnk files store normally one library spectrum per file, typically centroided and of MS level 2. In our short example below, we load data from a file containing multiple library spectra per file or from files with each a single spectrum provided with this package. Below we first load all required packages and define the paths to the Massbank files.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/RforMassSpectrometry/Spectra">Spectra</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/michaelwitting/MsBackendMassbank">MsBackendMassbank</a></span>)
<span class="kw">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, package = <span class="st">"MsBackendMassbank"</span>),
           full.names = <span class="fl">TRUE</span>, pattern = <span class="st">"txt$"</span>)
<span class="kw">fls</span>
</pre></div>
<pre><code>## [1] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/BSU00001.txt"       
## [2] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/MassBankRecords.txt"
## [3] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000501.txt"       
## [4] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000502.txt"       
## [5] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000503.txt"       
## [6] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000511.txt"       
## [7] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000512.txt"       
## [8] "/usr/local/lib/R/host-site-library/MsBackendMassbank/extdata/RP000513.txt"</code></pre>
<p>MS data can be accessed and analyzed through <code>Spectra</code> objects. Below we create a <code>Spectra</code> with the data from these mgf files. To this end we provide the file names and specify to use a <code><a href="../reference/MsBackendMassbank.html">MsBackendMassbank()</a></code> backend as <em>source</em> to enable data import. First we import from a single file with multiple library spectra.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html">Spectra</a></span>(<span class="kw">fls</span>[<span class="fl">1</span>],
               source = <span class="fu"><a href="../reference/MsBackendMassbank.html">MsBackendMassbank</a></span>(),
               backend = <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html">MsBackendDataFrame</a></span>())
</pre></div>
<pre><code>## Start data import from 1 files ... done</code></pre>
<p>With that we have now full access to all imported spectra variables that we list below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu">spectraVariables</span>(<span class="kw">sps</span>)
</pre></div>
<pre><code>##  [1] "msLevel"                 "rtime"                  
##  [3] "acquisitionNum"          "scanIndex"              
##  [5] "dataStorage"             "dataOrigin"             
##  [7] "centroided"              "smoothed"               
##  [9] "polarity"                "precScanNum"            
## [11] "precursorMz"             "precursorIntensity"     
## [13] "precursorCharge"         "collisionEnergy"        
## [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"
## [17] "isolationWindowUpperMz"  "accession"              
## [19] "name"                    "smiles"                 
## [21] "exact_mass"              "formula"                
## [23] "iupac"                   "link_cas"               
## [25] "link_pubchem"            "link_inchikey"          
## [27] "link_chemspider"         "ms_frag_mode"           
## [29] "chrom_column"            "focus_precursor_type"   
## [31] "title"</code></pre>
<p>The same is possible with multiple files, containing each one individual library spectrum.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html">Spectra</a></span>(<span class="kw">fls</span>[<span class="op">-</span><span class="fl">1</span>],
               source = <span class="fu"><a href="../reference/MsBackendMassbank.html">MsBackendMassbank</a></span>(),
               backend = <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html">MsBackendDataFrame</a></span>())
</pre></div>
<pre><code>## Start data import from 7 files ... done</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu">spectraVariables</span>(<span class="kw">sps</span>)
</pre></div>
<pre><code>##  [1] "msLevel"                 "rtime"                  
##  [3] "acquisitionNum"          "scanIndex"              
##  [5] "dataStorage"             "dataOrigin"             
##  [7] "centroided"              "smoothed"               
##  [9] "polarity"                "precScanNum"            
## [11] "precursorMz"             "precursorIntensity"     
## [13] "precursorCharge"         "collisionEnergy"        
## [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"
## [17] "isolationWindowUpperMz"  "accession"              
## [19] "name"                    "smiles"                 
## [21] "exact_mass"              "formula"                
## [23] "iupac"                   "link_cas"               
## [25] "link_pubchem"            "link_inchikey"          
## [27] "link_chemspider"         "ms_frag_mode"           
## [29] "chrom_column"            "focus_precursor_type"   
## [31] "title"</code></pre>
<p>By default the complete metadata is read together with the spectra. This can increase loading time. The different metadata blocks can blocked from reading. This requires to define an additional data frame indicating what shall be read.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># create data frame to indicate with metadata blocks shall be read.</span>
<span class="kw">metaDataBlocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(metadata = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ac"</span>, <span class="st">"ch"</span>, <span class="st">"sp"</span>, <span class="st">"ms"</span>, <span class="st">"record"</span>, <span class="st">"pk"</span>, <span class="st">"comment"</span>),
                             read = <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">FALSE</span>, <span class="fl">7</span>),
                             stringsAsFactors = <span class="fl">FALSE</span>)

<span class="kw">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html">Spectra</a></span>(<span class="kw">fls</span>[<span class="op">-</span><span class="fl">1</span>], source = <span class="fu"><a href="../reference/MsBackendMassbank.html">MsBackendMassbank</a></span>(), metaBlock = <span class="kw">metaDataBlocks</span>)
</pre></div>
<pre><code>## Start data import from 7 files ... done</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co"># variables only contain core variables</span>
<span class="fu">spectraVariables</span>(<span class="kw">sps</span>)
</pre></div>
<pre><code>##  [1] "msLevel"                 "rtime"                  
##  [3] "acquisitionNum"          "scanIndex"              
##  [5] "dataStorage"             "dataOrigin"             
##  [7] "centroided"              "smoothed"               
##  [9] "polarity"                "precScanNum"            
## [11] "precursorMz"             "precursorIntensity"     
## [13] "precursorCharge"         "collisionEnergy"        
## [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"
## [17] "isolationWindowUpperMz"  "accession"              
## [19] "name"                    "smiles"                 
## [21] "exact_mass"              "formula"                
## [23] "iupac"                   "link_cas"               
## [25] "link_pubchem"            "link_inchikey"          
## [27] "link_chemspider"         "ms_frag_mode"           
## [29] "chrom_column"            "focus_precursor_type"   
## [31] "title"</code></pre>
<p>Besides default spectra variables, such as <code>msLevel</code>, <code>rtime</code>, <code>precursorMz</code>, we also have additional spectra variables such as the <code>title</code> of each spectrum in the mgf file.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">sps</span><span class="op">$</span><span class="kw">rtime</span>
</pre></div>
<pre><code>##                       rtime  rtime  rtime  rtime  rtime  rtime 
## 142.14 142.14 142.14 142.14 142.14 142.14 143.94 143.94 143.94</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">sps</span><span class="op">$</span><span class="kw">title</span>
</pre></div>
<pre><code>##                                                      
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 10; R=; [M+H]+" 
##                                                      
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 20; R=; [M+H]+" 
##                                                      
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 40; R=; [M+H]+" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 10; R=; [M+H]+" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 20; R=; [M+H]+" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 40; R=; [M+H]+" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 10; R=; [M-H]-" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 20; R=; [M-H]-" 
##                                                title 
## "L-Tryptophan; LC-ESI-QTOF; MS2; CE: 40; R=; [M-H]-"</code></pre>
<p>In addition we can also access the m/z and intensity values of each spectrum.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu">mz</span>(<span class="kw">sps</span>)
</pre></div>
<pre><code>## NumericList of length 9
## [[""]] 74.0233 132.0807 144.0805 146.0598 ... 170.0597 188.0699 205.0965
## [[""]] 74.0232 77.0381 86.0027 91.0539 ... 160.0947 170.0596 171.0625 188.07
## [[""]] 53.0019 53.0383 63.0225 65.0381 ... 158.0817 159.0921 160.0755 170.06
## [["mz"]] 74.0233 132.0807 144.0805 146.0598 ... 170.0597 188.0699 205.0965
## [["mz"]] 74.0232 77.0381 86.0027 91.0539 ... 160.0947 170.0596 171.0625 188.07
## [["mz"]] 53.0019 53.0383 63.0225 65.0381 ... 158.0817 159.0921 160.0755 170.06
## [["mz"]] 72.0095 116.0517 117.0554 159.0935 186.0558 203.0826
## [["mz"]] 72.0094 74.0253 116.0511 117.0539 ... 162.0307 186.0548 203.0818
## [["mz"]] 74.0253 116.0508</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu">intensity</span>(<span class="kw">sps</span>)
</pre></div>
<pre><code>## NumericList of length 9
## [[""]] 646 980 2114 20052 1248 7628 2036 494048 75708
## [[""]] 10186 142 142 750 138 490 126 ... 14266 1478 1600 16504 1446 109762
## [[""]] 324 184 138 3770 500 800 7214 3238 ... 2802 206 898 162 166 814 250 1840
## [["intensity"]] 646 980 2114 20052 1248 7628 2036 494048 75708
## [["intensity"]] 10186 142 142 750 138 490 ... 14266 1478 1600 16504 1446 109762
## [["intensity"]] 324 184 138 3770 500 800 7214 ... 206 898 162 166 814 250 1840
## [["intensity"]] 150 200 32 232 80 12162
## [["intensity"]] 460 3630 658 74 28 190 44 142 50 52 634
## [["intensity"]] 282 424</code></pre>
<p>When importing a large number of mgf files, setting <code>nonStop = TRUE</code> prevents the call to stop whenever problematic mgf files are encountered.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="kw">sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html">Spectra</a></span>(<span class="kw">fls</span>, source = <span class="fu">MsBackendMgf</span>(), nonStop = <span class="fl">TRUE</span>)
</pre></div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
</pre></div>
<pre><code>## R version 4.0.2 Patched (2020-09-10 r79182)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.1 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-openmp/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
## [1] MsBackendMassbank_0.2.0 Spectra_0.99.4          ProtGenerics_1.21.0    
## [4] BiocParallel_1.23.2     S4Vectors_0.27.12       BiocGenerics_0.35.4    
## [7] BiocStyle_2.17.0       
## 
## loaded via a namespace (and not attached):
##  [1] cpp11_0.2.1         knitr_1.29          magrittr_1.5       
##  [4] MASS_7.3-53         MsCoreUtils_1.1.5   IRanges_2.23.10    
##  [7] R6_2.4.1            ragg_0.3.1          rlang_0.4.7        
## [10] stringr_1.4.0       tools_4.0.2         xfun_0.17          
## [13] htmltools_0.5.0     systemfonts_0.3.1   yaml_2.2.1         
## [16] assertthat_0.2.1    rprojroot_1.3-2     digest_0.6.25      
## [19] pkgdown_1.6.1.9000  crayon_1.3.4        bookdown_0.20      
## [22] BiocManager_1.30.10 fs_1.5.0            memoise_1.1.0      
## [25] evaluate_0.14       rmarkdown_2.3       stringi_1.5.3      
## [28] compiler_4.0.2      desc_1.2.0          backports_1.1.9</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Witting.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
